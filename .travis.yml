language:
  java

sudo:
  false

cache:
  directories:
    - $HOME/.m2
    - $HOME/.sonar/cache

services:
  - docker

install:
  skip

addons:
  sonarcloud:
    organization: "piggyback"

script:
  - mvn clean verify sonar:sonar -Dsonar.projectKey=piggy1-mvn_piggyback-partner
  - docker build -t piggy1/partner .

deploy:
  provider: script
  script: bash docker_push
  on:
    branch: master

after_success:
  - bash <(curl -s https://codecov.io/bash)
